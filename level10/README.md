# level09 - Reverse Hash

## Summary

on our `HOME` (`/home/user/level09`), we find two interesting files: a binary (`level09`) with **suid set** and a regular file (`token`)

```shell
~$ ls -l

-rwsr-sr-x 1 flag09 level09 7640 Mar  5  2016 level09
----r--r-- 1 flag09 level09   26 Mar  5  2016 token
```
<br>

After some testing, we figured out that the binary encrypt each strings input by this way:
- **Each encode character is equal to the original character plus its associated index.**

```shell
~~$ ./level09 abcdef
acegik
```

It is therefore understood that the result will be the opposite of
the actual behavior of the program to calculate the key from the contents
of the file "token‚Äù

<br>

## Exploit

- First, create the program to decode the token
  
```shell
~$ cat /tmp/exploit09.py

import sys

def encript(code):
    tmp = ""
    for index, letter in enumerate(code):
            tmp += chr(ord(letter) - index)
    print(tmp)

encript(sys.argv[1])
```
- Second, compute the flag09's password
``` shell
python /tmp/exploit09.py `cat ~/token`
```
